# SmartBuoy – Claude / Codex quick reference

Use this for fast context when working in the SmartBuoy Astro repo.

## Quick start

1. **Node**: Use `^18.17.1 || ^20.3.0 || >= 21.0.0`.
2. **Install**: `npm ci`
3. **Dev**: `npm run dev` (generates statistics then starts Astro dev server).
4. **Build**: `npm run build` (generates statistics then builds).
5. **Lint/format**: `npm run check` then `npm run fix` if needed.

## Stack

- Astro 5 + TypeScript + React 19 + Tailwind
- Sanity CMS; blog in `src/data/post/` (MD/MDX)
- i18n: `en` (default), `de` under `src/pages/de/`
- Netlify deploy; Docker/nginx in repo

## Guardrails

- **Do not edit `src/generated/statistics.ts`** – it is generated by `scripts/generate-statistics.mjs`. Change the script or API/env instead. The script runs on `predev` and `prebuild`.
- **Blog schema**: New or changed post frontmatter must match `src/content/config.ts` (e.g. `title`, `publishDate`, `category`, `tags`).
- **Checks**: Prefer `npm run check` and `npm run fix` so Astro, ESLint, and Prettier stay consistent.
- **Translations**: File-based i18n. Default `en` pages are in `src/pages/`, and `de` pages must mirror them under `src/pages/de/`. Every page and URL must be in the correct language, so new pages/routes/content must be added for all supported languages.

## Key paths

| What | Where |
|------|--------|
| Pages | `src/pages/`, `src/pages/de/` |
| Layouts | `src/layouts/` |
| Components | `src/components/` |
| Blog posts | `src/data/post/` |
| Blog schema | `src/content/config.ts` |
| Styles | `src/assets/styles/` |
| Sanity | `schemas/`, `src/utils/sanity.ts` |
| Generated stats | `src/generated/statistics.ts` (read-only); generator `scripts/generate-statistics.mjs` |

## Env (optional)

For the statistics script: `STATISTICS_API_URL`, `STATISTICS_API_KEY`. Load order: `.env`, `.env.local`, then mode-specific (e.g. `.env.development`). See `scripts/generate-statistics.mjs`.
